# -*- coding: utf-8 -*-
from dajax.core import Dajax
from dajaxice.decorators import dajaxice_register
from library.models import Graduate, Title, School, Country, Town

@dajaxice_register
def updatecombo(request, option):
    dajax = Dajax()
    town_list = Town.objects.filter( country__name = option )
    out = []
    for town in town_list:
        out.append(u'<option value="{0}">{1}</option>'.format(town.name, town.name))
    dajax.script(u'set_town("%s");' % town_list[0])
    dajax.assign('select[name="town"]', 'innerHTML', ''.join(out))
    return dajax.json()
